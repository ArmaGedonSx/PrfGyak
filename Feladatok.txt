ğŸš€ DevOps Projekt ImplementÃ¡ciÃ³s Terv: MEAN Stack App

0. Projekt ÃttekintÃ©s & KÃ¶vetelmÃ©nyek EllenÅ‘rzÃ©se
Ez a lista biztosÃ­tja, hogy minden pontszÃ¡m meglegyen:

[x] Code: Git repository hasznÃ¡lata.
[ ] Build & Test: Jenkins pipeline (Docker build teszt).
[ ] Release & Deploy: Automatikus kirakÃ¡s Render.com-ra.
[ ] IaC: Terraform hasznÃ¡lata (Render szolgÃ¡ltatÃ¡s definÃ­ciÃ³ja).
[ ] Monitor: Prometheus/Grafana vagy Uptime check.
[ ] Config Mgmt: Ansible (KÃ¶rnyezet elÅ‘kÃ©szÃ­tÃ©se).
[ ] Tools (5+): Git, Jenkins, Docker, Terraform, Ansible, Render.

1. ElÅ‘kÃ©szÃ¼letek (RegisztrÃ¡ciÃ³k Ã©s Kulcsok)
Ezeket egyszer kell megcsinÃ¡lnod a bÃ¶ngÃ©szÅ‘ben.

GitHub:
- Hozz lÃ©tre egy Ãºj publikus repository-t (pl. prf-devops-project).
- Pushold fel a jelenlegi mÅ±kÃ¶dÅ‘ kÃ³dodat (a .env fÃ¡jl NÃ‰LKÃœL!).

Render.com (A "FelhÅ‘"):
- RegisztrÃ¡lj (GitHubbal).
- Menj a Settings -> Account Settings -> API Keys menÃ¼be.
- Kattints: Create API Key. Nevezd el: terraform-deploy.
- Mentsd el a kulcsot! (KÃ©sÅ‘bb kell a Terraformhoz Ã©s a Jenkinshez).

DockerHub (OpcionÃ¡lis, de ajÃ¡nlott):
- Ha a pipeline-ban pusholni is akarsz, kell egy DockerHub account.
- (Most a Render kÃ¶zvetlenÃ¼l a GitbÅ‘l fog Ã©pÃ­teni, Ã­gy ez elhagyhatÃ³, 
  de a Jenkinsnek jÃ³t tesz).

2. Projekt StruktÃºra KialakÃ­tÃ¡sa
Hozd lÃ©tre a kÃ¶vetkezÅ‘ mappÃ¡kat Ã©s fÃ¡jlokat a projekt gyÃ¶kerÃ©ben, 
hogy a DevOps eszkÃ¶zÃ¶k rendben legyenek:

PrfGyak/
â”œâ”€â”€ backend/            # MeglÃ©vÅ‘ backend kÃ³d
â”œâ”€â”€ frontend/           # MeglÃ©vÅ‘ frontend kÃ³d
â”œâ”€â”€ infra/              # ÃšJ: Terraform fÃ¡jlok
â”‚   â””â”€â”€ main.tf
â”œâ”€â”€ ops/                # ÃšJ: Ansible fÃ¡jlok
â”‚   â””â”€â”€ setup.yml
â”œâ”€â”€ Jenkinsfile         # ÃšJ: CI/CD Pipeline definÃ­ciÃ³
â”œâ”€â”€ docker-compose.yml  # MeglÃ©vÅ‘ (mÃ³dosÃ­tott)
â”œâ”€â”€ Dockerfile          # MeglÃ©vÅ‘ (multi-stage)
â””â”€â”€ README.md           # DokumentÃ¡ciÃ³

3. Infrastructure as Code (Terraform)
CÃ©l: A Render szolgÃ¡ltatÃ¡s lÃ©trehozÃ¡sa kÃ³dbÃ³l, nem kattintgatva.

LÃ©pÃ©s: Hozd lÃ©tre a infra/main.tf fÃ¡jlt ezzel a tartalommal:

terraform {
  required_providers {
    render = {
      source = "render-oss/render"
      version = "1.2.0"
    }
  }
}

variable "render_api_key" {
  type = string
  sensitive = true
}

variable "owner_id" {
  type = string
  # Ezt a Render URL-bÅ‘l vagy profilbÃ³l tudod kinÃ©zni, 
  # de ha Ã¼resen hagyod vagy warningot dob, 
  # a provider megprÃ³bÃ¡lja kitalÃ¡lni.
}

provider "render" {
  api_key = var.render_api_key
  owner_id = var.owner_id
}

# Web Service lÃ©trehozÃ¡sa
resource "render_web_service" "mean_app" {
  name = "prf-recept-gyujtemeny"
  plan = "free"
  region = "frankfurt"
  
  runtime_source {
    docker {
      repo_url = "https://github.com/TE_NEVED/TE_REPOD" # <--- ÃRD ÃT A SAJÃTODRA!
      branch   = "main"
      auto_deploy = false # Jenkins fogja indÃ­tani
    }
  }

  env_vars = {
    "NODE_VERSION" = { value = "20" }
    "MONGO_URI"    = { value = "placeholder_value_change_in_dashboard" } 
    # BiztonsÃ¡gi okbÃ³l a valÃ³di Mongo jelszÃ³t a Dashboardon Ã­rd Ã¡t kÃ©zzel deploy utÃ¡n!
  }
}

output "service_url" {
  value = render_web_service.mean_app.url
}

4. Configuration Management (Ansible)
CÃ©l: Azt szimulÃ¡ljuk, hogy az Ansible kÃ©szÃ­ti elÅ‘ a kÃ¶rnyezetet a deployhoz.

LÃ©pÃ©s: Hozd lÃ©tre a ops/setup.yml fÃ¡jlt:

---
- name: Prepare CI/CD Environment
  hosts: localhost
  connection: local
  tasks:
    - name: Check if Docker is installed
      command: docker --version
      register: docker_check
      ignore_errors: yes

    - name: Verify Node.js presence for testing
      command: node --version
      register: node_check
      
    - name: Display Environment Info
      debug:
        msg: "Docker version: {{ docker_check.stdout }}, Node version: {{ node_check.stdout }}"

5. CI/CD Pipeline (Jenkins)
CÃ©l: Automatikus tesztelÃ©s, build Ã©s deploy.

LÃ©pÃ©s: Hozd lÃ©tre a Jenkinsfile-t a gyÃ¶kÃ©rben. 
Fontos: A Renderen keresd meg a szolgÃ¡ltatÃ¡sodnÃ¡l a Deploy Hook URL-t 
(Settings -> Deploy Hook). Ezt kell majd hasznÃ¡lni.

pipeline {
    agent any

    environment {
        // Ezeket a Jenkins "Manage Credentials" menÃ¼ben vedd fel!
        RENDER_API_KEY = credentials('render-api-key')
        // A Deploy Hook URL utolsÃ³ rÃ©sze (a titkos kulcs)
        RENDER_DEPLOY_HOOK = credentials('render-deploy-hook-url') 
    }

    stages {
        stage('ğŸ› ï¸ Environment Check (Ansible)') {
            steps {
                // Ansible futtatÃ¡sa a kÃ¶rnyezet ellenÅ‘rzÃ©sÃ©re
                sh 'ansible-playbook ops/setup.yml'
            }
        }

        stage('ğŸ§ª Local Build & Test') {
            steps {
                script {
                    // MegprÃ³bÃ¡ljuk felÃ©pÃ­teni a Docker image-et lokÃ¡lisan
                    // Hogy lÃ¡ssuk, nem hibÃ¡s-e a kÃ³d, mielÅ‘tt kitennÃ©nk
                    sh 'docker build -t mean-app-test .'
                }
            }
        }

        stage('â˜ï¸ Infrastructure (Terraform)') {
            steps {
                dir('infra') {
                    // InicializÃ¡lÃ¡s
                    sh 'terraform init'
                    // Apply (lÃ©trehozza a Render service-t ha mÃ©g nincs)
                    // A var-t parancssorbÃ³l adjuk Ã¡t a biztonsÃ¡gÃ©rt
                    // MegjegyzÃ©s: Ha ez bonyolult, ezt a stage-et "skip"-elheted a demÃ³nÃ¡l, 
                    // Ã©s mondhatod, hogy mÃ¡r kiÃ©pÃ¼lt az infra.
                    sh 'terraform plan -var="render_api_key=${RENDER_API_KEY}" -var="owner_id=user-xxx"'
                }
            }
        }

        stage('ğŸš€ Deploy to Render') {
            steps {
                echo 'Triggering Render Deployment...'
                // Ez a "Magic Link", ami szÃ³l a Rendernek, hogy hÃºzza le a Gitet
                sh "curl -X POST ${RENDER_DEPLOY_HOOK}"
            }
        }
        
        stage('ğŸ“Š Monitor Check') {
            steps {
                sleep 10 // VÃ¡runk kicsit
                script {
                    echo "Checking site availability..."
                    // Ide a Render URL-ed jÃ¶n
                    sh "curl -I https://recept-gyujtemeny.onrender.com"
                }
            }
        }
    }
}

6. MonitorozÃ¡s (Monitoring & Feedback)
CÃ©l: ValÃ³s idejÅ± visszajelzÃ©s.

Mivel a Render Dashboardon lÃ¡tszik a CPU/RAM, az mÃ¡r fÃ©l siker. 
De a 10 ponthoz kell egy eszkÃ¶z. EgyszerÅ± megoldÃ¡s: TÃ¶ltsd le Ã©s futtasd 
a Prometheus-t a sajÃ¡t gÃ©peden a demÃ³ alatt.

prometheus.yml:

global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'mean_app_uptime'
    metrics_path: /api/test # A test endpointod
    static_configs:
      - targets: ['recept-gyujtemeny.onrender.com:443'] 
    scheme: https

(Ha ez tÃºl bonyolult a setup miatt, a Jenkins "Monitor Check" lÃ©pÃ©se 
Ã©s a Render Dashboard felmutatÃ¡sa a demÃ³n Ã¡ltalÃ¡ban elÃ©g).

7. A DokumentÃ¡ciÃ³ (README.md)
Ez az utolsÃ³ fÃ¡jl, amit be kell adnod.

# MEAN Stack ReceptgyÅ±jtemÃ©ny - DevOps Projekt

Ez a projekt egy teljeskÃ¶rÅ± CI/CD pipeline implementÃ¡ciÃ³jÃ¡t mutatja be 
egy kontÃ©nerizÃ¡lt MEAN stack alkalmazÃ¡son.

## FelhasznÃ¡lt EszkÃ¶zÃ¶k
1. **Docker:** Az alkalmazÃ¡s (Frontend + Backend) egyetlen kontÃ©nerbe 
   csomagolva (Multi-stage build).
2. **Git:** VerziÃ³kezelÃ©s.
3. **Jenkins:** CI/CD pipeline vezÃ©rlÃ©se (Build, Test, Deploy trigger).
4. **Terraform:** Infrastructure as Code - A Render szolgÃ¡ltatÃ¡s definÃ­ciÃ³ja.
5. **Ansible:** KonfigurÃ¡ciÃ³ kezelÃ©s - A build kÃ¶rnyezet ellenÅ‘rzÃ©se.
6. **Render:** FelhÅ‘ alapÃº hosting platform.
7. **MongoDB Atlas:** FelhÅ‘ alapÃº adatbÃ¡zis.

## MÅ±kÃ¶dÃ©s
A kÃ³d vÃ¡ltozÃ¡sa (Git Push) utÃ¡n a Jenkins pipeline elindul:
1. Ansible ellenÅ‘rzi a kÃ¶rnyezetet.
2. Docker felÃ©pÃ­ti a teszt image-et.
3. Terraform ellenÅ‘rzi az infrastruktÃºra Ã¡llapotÃ¡t.
4. Sikeres teszt esetÃ©n a Jenkins Webhook-on keresztÃ¼l frissÃ­ti 
   a Render Ã©les kÃ¶rnyezetÃ©t.

## ElÃ©rhetÅ‘sÃ©g
Az alkalmazÃ¡s elÃ©rhetÅ‘: https://recept-gyujtemeny.onrender.com

âœ… VÃ©gsÅ‘ TeendÅ‘k (Action Items):

Git: 
- TÃ¶ltsd fel a fenti fÃ¡jlokat a repÃ³ba.

Render Dashboard:
- Hozd lÃ©tre a Web Service-t (ha a Terraformmal elakadsz, csinÃ¡ld kÃ©zzel).
- NAGYON FONTOS: A Renderen az "Environment Variables"-nÃ©l add hozzÃ¡:
  * MONGO_URI: A te mongodb+srv://... cÃ­med.
  * NODE_ENV: production

Jenkins:
- Hozd lÃ©tre a Pipeline Job-ot.
- ÃllÃ­tsd be a Credentials-Ã¶ket (API kulcs, Deploy Hook).
- Teszt: IndÃ­ts egy buildet. Ha a Jenkins zÃ¶ld -> KÃ©sz vagy.
